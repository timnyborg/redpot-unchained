{% extends 'feedback_layout.html' %}
{% load feedback_tags %}
{% load crispy_forms_tags %}

{% block center %}
    <div class="section">
        <a href="{% url 'feedback:export_users_xls' module_info.id %}" class="btn btn-secondary float-end"><span class="fa fa-file"></span> Export (.xls)</a>
        <br>
        <h4>Summary</h4>

        <table class="table table-condensed table-striped hide-rows table-bordered">
            <tr style="text-align: right">
                <th>Module Title</th>
                <th>Satisfied (%)</th>
                <th>Average</th>
                <th>Teaching</th>
                <th>Content</th>
                <th>Facilities</th>
                <th>Admin</th>
                <th>Catering</th>
                <th>Accomm</th>
                <th>Sent</th>
                <th>Returned</th>
            </tr>
            <tr style="text-align: right">
                <td class="feedback-comment">{{ module_info.title }} ({{ module_info.code }})<br> ({{ module_info.start_date }} - {{ module_info.end_date }})</td>
                <td>{{ module_summary.satisfied | default:'-'}}</td>
                <td class="{% score_color module_summary.average %}">{{ module_summary.average }}</td>
                <td class="{% score_color module_summary.content %}">{{ module_summary.content }}</td>
                <td class="{% score_color module_summary.teaching %}">{{ module_summary.teaching }}</td>
                <td class="{% score_color module_summary.facility %}">{{ module_summary.facility }}</td>
                <td class="{% score_color module_summary.admin %}">{{ module_summary.admin }}</td>
                <td class="{% score_color module_summary.catering %}">{{ module_summary.catering }}</td>
                <td class="{% score_color module_summary.accommodation %}">{{ module_summary.accommodation }}</td>
                <td class="feedback-gray">{{ module_summary.sent }}</td>
                <td class="feedback-gray">{{ module_summary.returned | default:'-'}}</td>
            </tr>
        </table>
        <hr>
        <h4>Detail</h4>
        {% for feedback in feedback_data_dict.values %}
            <table class = "table table-striped table-hover table-bordered">
                <tbody>
                    <tr>
                        <td class="feedback-green feedback-comment">
                            <b>{{ feedback.name }}</b> submitted at {{ feedback.submitted_on }}
                        </td>
                        <td class="{% score_color feedback.average %}">{{ feedback.average | default:'-' }}<br>Average</td>
                        <td class="{% score_color feedback.teaching %}">{{ feedback.teaching | default:'-' }}<br>Teaching</td>
                        <td class="{% score_color feedback.content %}">{{ feedback.content | default:'-' }}<br>Content</td>
                        <td class="{% score_color feedback.facilities %}">{{ feedback.facilities | default:'-' }}<br>Facilities</td>
                        <td class="{% score_color feedback.admin %}">{{ feedback.admin | default:'-' }}<br>Admin</td>
                        <td class="{% score_color feedback.catering %}">{{ feedback.catering | default:'-' }}<br>Catering</td>
                        <td class="{% score_color feedback.accommodation %}">{{ feedback.accommodation | default:'-' }}<br>Accomm</td>
                    </tr>
                    <tr>
                        <td colspan="8">{{ feedback.comment | default:'No comment'}}</td>
                    </tr>
                </tbody>
            </table>
        {% endfor %}
        <hr>

        <h4>Course administrator / director comments</h4>
        <p>Please use to record any follow up actions</p>
        <table class = "table table-striped table-bordered">
            <tbody>
                {% for comment in comments_list %}
                <tr>
                    <td>{{ comment.comment }}</td>
                    <td>{{ comment.uploaded_by }}. {{ comment.uploaded_on }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <form method="POST" action=''>
            {% csrf_token %}
            {{ form|crispy }}
            <input type="submit" value="Submit comment and send report to ...">
        </form>

    </div>
{% endblock %}
